<form theme="dark">
  <label>COVID19 Japan (specific prefecture)</label>
  <init>
    <set token="prefectures_last_date">-</set>
    <unset token="first_date"></unset>
    <unset token="debug">true</unset>
    <set token="predict_flag">0</set>
    <unset token="use_predict"></unset>
    <set token="predict_query_prefix">eval _dummy="</set>
    <set token="predict_query_postfix">"</set>
    <set token="map_center">(35.66,139.54)</set>
  </init>
  <search id="annotation_base">
    <query>
      | inputlookup covid19japan_events.csv
      | where annotation_category=="common" OR annotation_category="japan_tracker"
      | fields _time, annotation_label, annotation_category, annotation_color
    </query>
    <refresh>30m</refresh>
  </search>
  <search>
    <query>
      | inputlookup prefecturelist
      | search Prefecture="$target_prefecture$"
      | rename "都道府県" as Prefecture_ja
      | fields Prefecture_ja
    </query>
    <done>
      <set token="target_prefecture_ja">$result.Prefecture_ja$</set>
    </done>
  </search>
  <search>
    <query>
      | inputlookup capitaljapan
      | search "都道府県"="$target_prefecture_ja$"
      | eval lat=googlelat, long=googlelong
      | fields lat, long
    </query>
    <done>
      <set token="map_center">($result.lat$,$result.long$)</set>
    </done>
  </search>
  <!-- 
  <row>
    <panel depends="$debug$">
      <title>感染クラスタマップ</title>
      <map>
        <search base="prefectures_all_base">
          <query>

            | dedup name
            | fields name_ja, confirmed, deceased, recovered
            | appendpipe 
              [
                | eval pref_confirmed=name_ja . ":感染"
                | fields name_ja, pref_confirmed, confirmed 
              ]
            | appendpipe
              [
                | eval pref_deceased=name_ja . ":死亡"
                | fields name_ja, pref_deceased, deceased
              ]
            | appendpipe
              [
                | eval pref_recovered=name_ja . ":回復"
              | fields name_ja, pref_recovered, recovered
              ]
            | where NOT (isnull(pref_confirmed) AND isnull(pref_deceased) AND isnull(pref_recovered))
            | eval status=case(NOT isnull(pref_confirmed), pref_confirmed, NOT isnull(pref_deceased), pref_deceased, NOT isnull(pref_recovered), pref_recovered)
            | eval count=case(NOT isnull(pref_confirmed), confirmed, NOT isnull(pref_deceased), deceased, NOT isnull(pref_recovered), recovered)
            | rename name_ja as "都道府県"
            | lookup capitaljapan "都道府県" outputnew googlelat as lat, googlelong as lon
            | geostats globallimit=0 maxzoomlevel=18 values(count) by status
          </query>
        </search>
        <option name="height">662</option>
        <option name="drilldown">none</option>
        <option name="mapping.choroplethLayer.colorBins">5</option>
        <option name="mapping.choroplethLayer.colorMode">auto</option>
        <option name="mapping.choroplethLayer.maximumColor">0xaf575a</option>
        <option name="mapping.choroplethLayer.minimumColor">0x62b3b2</option>
        <option name="mapping.choroplethLayer.neutralPoint">0</option>
        <option name="mapping.choroplethLayer.shapeOpacity">0.75</option>
        <option name="mapping.choroplethLayer.showBorder">1</option>
        <option name="mapping.data.maxClusters">100</option>
        <option name="mapping.legend.placement">bottomright</option>
        <option name="mapping.map.center">$map_center$</option>
        <option name="mapping.map.panning">1</option>
        <option name="mapping.map.scrollZoom">0</option>
        <option name="mapping.map.zoom">7</option>
        <option name="mapping.markerLayer.markerMaxSize">200</option>
        <option name="mapping.markerLayer.markerMinSize">75</option>
        <option name="mapping.markerLayer.markerOpacity">0.9</option>
        <option name="mapping.showTiles">1</option>
        <option name="mapping.tileLayer.attribution">マップ出典: 地理院タイル (https://maps.gsi.go.jp/development/ichiran.html)</option>
        <option name="mapping.tileLayer.maxZoom">18</option>
        <option name="mapping.tileLayer.minZoom">5</option>
        <option name="mapping.tileLayer.tileOpacity">0.7</option>
        <option name="mapping.tileLayer.url">https://cyberjapandata.gsi.go.jp/xyz/pale/{z}/{x}/{y}.png</option>
        <option name="mapping.type">marker</option>
        <option name="trellis.enabled">0</option>
        <option name="trellis.scales.shared">1</option>
        <option name="trellis.size">medium</option>
      </map>
    </panel>
  </row>
-->
  <fieldset submitButton="false" autoRun="true">
    <input type="dropdown" token="target_prefecture" searchWhenChanged="true">
      <label>都道府県</label>
      <fieldForLabel>都道府県</fieldForLabel>
      <fieldForValue>Prefecture</fieldForValue>
      <search>
        <query>
          | inputlookup prefecturelist
          | fields "都道府県", "Prefecture"
        </query>
      </search>
      <default>Tokyo</default>
      <initialValue>Tokyo</initialValue>
    </input>
  </fieldset>
  <row>
    <panel>
      <html>
        <h1>COVID19 Japan $target_prefecture_ja$ 状況 ($prefectures_last_date$ 現在)</h1>
      </html>
    </panel>
  </row>
  <row depends="$debug$">
    <panel depends="$debug$">
      <title>感染者全件 (デバッグ用)</title>
      <table>
        <search id="patient_all_base">
          <query>
            index=covid19japan source="*-patient_data_latest.json" earliest=-1d patientId!=-1 confirmedPatient!="false" detectedPrefecture=$target_prefecture$
            | dedup patientId
            | eval _time=strptime(dateAnnounced, "%F")
            | fields _time, patientId, confirmedPatient, detectedPrefecture, detectedCityTown, dateAnnounced, patientStatus, deceasedDate, gender, ageBracket, residence,  sourceURL
          </query>
          <earliest>$earliest$</earliest>
          <latest>$latest$</latest>
          <refresh>30m</refresh>
          <refreshType>delay</refreshType>
        </search>
        <option name="count">3</option>
        <option name="refresh.display">progressbar</option>
        <fields>["_time","patientId","confirmedPatient","detectedPrefecture","detectedCityTown","dateAnnounced","patientStatus","deceasedDate","gender","ageBracket","residence","sourceURL"]</fields>
      </table>
    </panel>
    <panel depends="$debug$">
      <title>サマリ全件 (デバッグ用)</title>
      <table>
        <search id="summary_all_base">
          <query>
            | inputlookup covid19japan_daily_summary.csv
            | fields _time, updated, confirmed, confirmedAvg3d, confirmedAvg7d, confirmedCumulative, confirmedCumulativeAvg3d, confirmedCumulativeAvg7d, criticalCumulative, deceased, deceasedCumulative, recoveredCumulative, testedCumulative
          </query>
          <refresh>30m</refresh>
          <refreshType>delay</refreshType>
        </search>
        <option name="count">3</option>
        <option name="refresh.display">progressbar</option>
        <fields>["_time","updated","confirmed","confirmedAvg3d","confirmedAvg7d","confirmedCumulative","confirmedCumulativeAvg3d","confirmedCumulativeAvg7d","criticalCumulative","deceased","deceasedCumulative","recoveredCumulative","testedCumulative"]</fields>
      </table>
    </panel>
    <panel depends="$debug$">
      <title>更新日時 (デバッグ用)</title>
      <single>
        <search base="summary_all_base">
          <query>
<!-- summary_all_base -->
            | eval upd=strptime(updated, "%FT%T%z")
            | stats max(upd) as mt
            | eval max_date=strftime(mt, "%Y/%m/%d %H:%M")
            | fields max_date
          </query>
        </search>
        <option name="drilldown">none</option>
      </single>
    </panel>
    <panel depends="$debug$">
      <title>最古日時 (デバッグ用)</title>
      <single>
        <search id="get_first_date" base="summary_all_base">
          <query>
<!-- get_all_patient -->
            | stats min(_time) as mt
            | eval min_date=strftime(mt, "%Y/%m/%d")
            | fields min_date
          </query>
          <progress>
            <unset token="first_date">-</unset>
          </progress>
          <done>
            <set token="first_date">$result.min_date$</set>
          </done>
        </search>
        <option name="drilldown">none</option>
      </single>
    </panel>
  </row>
  <row depends="$debug$">
    <panel depends="$debug$">
      <title>県別全件 (デバッグ用)</title>
      <table>
        <search id="prefectures_all_base">
          <query>
            | inputlookup covid19japan_confirmed_by_prefecture_summary.csv
            | search name=$target_prefecture$
            | join _time, name
              [
                | inputlookup covid19japan_deceased_by_prefecture_summary.csv
                | search name=$target_prefecture$
                | fields *
              ]
            | fields _time, updated, name, name_ja, min_time, gc_min_time, dailyConfirmedStartDate, days_confirmed_count, daily_confirmed, gd_min_time, dailyDeceasedStartDate, days_deceased_count, daily_deceased, newlyConfirmed, yesterdayConfirmed, cumulativeConfirmed, newlyDeceased, yesterdayDeceased, cumulativeDeceased, confirmed, deceased, recovered, cruisePassenger, confirmedByCity.*
          </query>
          <earliest>$earliest$</earliest>
          <latest>$latest$</latest>
          <refresh>30m</refresh>
          <refreshType>delay</refreshType>
        </search>
        <option name="count">3</option>
        <option name="refresh.display">progressbar</option>
        <fields>["_time","updated","name","name_ja","newlyConfirmed","yesterdayConfirmed","cumulativeConfirmed","newlyDeceased","yesterdayDeceased","cumulativeDeceased","confirmed","deceased","recovered"]</fields>
      </table>
    </panel>
    <panel depends="$debug$">
      <title>県別サマリ (デバッグ用)</title>
      <table>
        <search base="prefectures_all_base" id="prefecture_summary">
          <query>
            | search name!="Diamond Princess Cruise Ship" 
            | eval name_ja=if((name_ja="" OR isnull(name_ja)),"不明",name_ja)
            | sort 0 - _time
            | fields updated, name_ja, confirmed, newlyConfirmed, yesterdayConfirmed, cumulativeConfirmed, deceased, newlyDeceased, yesterdayDeceased, cumulativeDeceased, recovered
            | sort - confirmed deceased recovered
          </query>
        </search>
        <option name="count">3</option>
      </table>
    </panel>
    <panel depends="$debug$">
      <title>県別日毎 (デバッグ用)</title>
      <table>
        <search base="prefectures_all_base">
          <query>
<!-- prefectures_all_base -->
          </query>
        </search>
        <option name="count">3</option>
      </table>
    </panel>
    <panel depends="$debug$">
      <title>日別患者数 (デバッグ用)</title>
      <table>
        <search base="prefectures_all_base" id="daily_cofirmed_base">
          <query>
<!-- prefectures_all_base -->
            | fields _time, name_ja, daily_confirmed
            | xyseries _time, name_ja, daily_confirmed
        </query>
        </search>
        <option name="count">3</option>
      </table>
    </panel>
    <panel depends="$debug$">
      <title>県別更新日時 (デバッグ用)</title>
      <single>
        <search id="get_prefectures_last_date" base="prefectures_all_base">
          <query>
<!-- summary_all_base -->
            | eval upd=strptime(updated, "%FT%T%z")
            | stats max(upd) as mt
            | eval max_date=strftime(mt, "%Y/%m/%d %H:%M")
            | fields max_date
          </query>
          <progress>
            <set token="prefectures_last_date">-</set>
          </progress>
          <done>
            <set token="prefectures_last_date">$result.max_date$</set>
          </done>
        </search>
        <option name="drilldown">none</option>
      </single>
    </panel>
  </row>
  <row>
    <panel>
      <title>感染者数累積</title>
      <single>
        <search base="prefecture_summary">
          <query>
<!-- prefecture_summary -->
            | timechart span=1d values(cumulativeConfirmed)
          </query>
        </search>
        <option name="height">100</option>
        <option name="colorMode">none</option>
        <option name="drilldown">none</option>
        <option name="rangeColors">["0xFFFFFF","0xff88ff","0xffcccc","0xff8888","0xff4444","0xff0000"]</option>
        <option name="rangeValues">[0,2000,4000,8000,10000]</option>
        <option name="refresh.display">progressbar</option>
        <option name="underLabel">感染者累積</option>
        <option name="unit">名</option>
        <option name="useColors">1</option>
      </single>
    </panel>
    <panel>
      <title>感染者数 ( 累積 - ( 回復 + 死亡 ) )</title>
      <single>
        <search base="prefecture_summary">
          <query>
<!-- prefecture_summary -->
            | eval alive=confirmed - (deceased + recovered)
            | table _time, alive
          </query>
        </search>
        <option name="drilldown">none</option>
        <option name="height">100</option>
        <option name="rangeColors">["0xFFFFFF","0xff88ff","0xffcccc","0xff8888","0xff4444","0xff0000"]</option>
        <option name="rangeValues">[0,2000,4000,8000,10000]</option>
        <option name="refresh.display">progressbar</option>
        <option name="showSparkline">0</option>
        <option name="showTrendIndicator">0</option>
        <option name="underLabel">陽性</option>
        <option name="unit">名</option>
        <option name="useColors">1</option>
      </single>
    </panel>
    <panel>
      <title>死亡者数</title>
      <single>
        <search base="prefecture_summary">
          <query>
<!-- prefecture_summary -->
            | timechart span=1d values(cumulativeDeceased)
          </query>
        </search>
        <option name="height">100</option>
        <option name="colorBy">value</option>
        <option name="colorMode">none</option>
        <option name="drilldown">none</option>
        <option name="numberPrecision">0</option>
        <option name="rangeColors">["0xFFFFFF","0xff88ff","0xffcccc","0xff8888","0xff4444","0xff0000"]</option>
        <option name="rangeValues">[0,50,100,200,500]</option>
        <option name="showSparkline">1</option>
        <option name="showTrendIndicator">1</option>
        <option name="trellis.enabled">0</option>
        <option name="trellis.scales.shared">1</option>
        <option name="trellis.size">medium</option>
        <option name="trendColorInterpretation">standard</option>
        <option name="trendDisplayMode">absolute</option>
        <option name="underLabel">死亡</option>
        <option name="unit">名</option>
        <option name="unitPosition">after</option>
        <option name="useColors">1</option>
        <option name="useThousandSeparators">1</option>
      </single>
    </panel>
    <panel depends="$debug$">
      <title>重傷者数</title>
      <single>
        <search>
          <query>
            | makeresults 1
            | eval content="不明"
          </query>
        </search>
        <option name="colorBy">value</option>
        <option name="colorMode">none</option>
        <option name="drilldown">none</option>
        <option name="height">100</option>
        <option name="numberPrecision">0</option>
        <option name="rangeColors">["0xFFFFFF","0xff88ff","0xffcccc","0xff8888","0xff4444","0xff0000"]</option>
        <option name="rangeValues">[0,200,400,800,1000]</option>
        <option name="showSparkline">1</option>
        <option name="showTrendIndicator">1</option>
        <option name="trellis.enabled">0</option>
        <option name="trellis.scales.shared">1</option>
        <option name="trellis.size">medium</option>
        <option name="trendColorInterpretation">standard</option>
        <option name="trendDisplayMode">absolute</option>
        <option name="underLabel">重傷</option>
        <option name="unitPosition">after</option>
        <option name="useColors">1</option>
        <option name="useThousandSeparators">1</option>
      </single>
    </panel>
    <panel>
      <title>回復者数</title>
      <single>
        <search base="prefecture_summary">
          <query>
<!-- prefecture_summary -->
            | table _time, recovered
          </query>
        </search>
        <option name="colorBy">value</option>
        <option name="colorMode">none</option>
        <option name="drilldown">none</option>
        <option name="height">100</option>
        <option name="numberPrecision">0</option>
        <option name="rangeColors">["0xFFFFFF","0xff88ff","0xffcccc","0xff8888","0xff4444","0xff0000"]</option>
        <option name="rangeValues">[0,200,400,800,1000]</option>
        <option name="showSparkline">0</option>
        <option name="showTrendIndicator">0</option>
        <option name="trellis.enabled">0</option>
        <option name="trellis.scales.shared">1</option>
        <option name="trellis.size">medium</option>
        <option name="trendColorInterpretation">standard</option>
        <option name="trendDisplayMode">absolute</option>
        <option name="underLabel">回復</option>
        <option name="unit">名</option>
        <option name="unitPosition">after</option>
        <option name="useColors">0</option>
        <option name="useThousandSeparators">1</option>
      </single>
    </panel>
  </row>
  <row>
    <panel>
      <title>感染者 $current_confirmed_date$ 公表分</title>
      <single>
        <search base="prefecture_summary" id="published_confirmed">
          <query>
<!-- prefecture_summary -->
            | timechart span=1d values(newlyConfirmed)
          </query>
        </search>
        <option name="colorBy">trend</option>
        <option name="colorMode">none</option>
        <option name="drilldown">none</option>
        <option name="numberPrecision">0</option>
        <option name="rangeColors">["0x53a051","0x0877a6","0xf8be34","0xf1813f","0xdc4e41"]</option>
        <option name="rangeValues">[0,30,70,100]</option>
        <option name="showSparkline">1</option>
        <option name="showTrendIndicator">1</option>
        <option name="trellis.enabled">0</option>
        <option name="trellis.scales.shared">1</option>
        <option name="trellis.size">medium</option>
        <option name="trendColorInterpretation">inverse</option>
        <option name="trendDisplayMode">absolute</option>
        <option name="underLabel">感染者 本日公表分</option>
        <option name="unit">名</option>
        <option name="unitPosition">after</option>
        <option name="useColors">1</option>
        <option name="useThousandSeparators">1</option>
      </single>
    </panel>
    <panel depends="$debug$">
      <title>感染者 公表日 (デバッグ用)</title>
      <single>
        <search base="published_confirmed">
          <query>
<!-- published_confirmed -->
            | tail 1
            | eval time=strftime(_time, "%Y/%m/%d")
            | fields time
          </query>
          <done>
            <set token="current_confirmed_date">$result.time$</set>
          </done>
        </search>
        <option name="underLabel">感染者 公表日</option>
      </single>
    </panel>
    <panel>
      <title>感染者 昨日 ($last_confirmed_date$) 公表分</title>
      <single>
        <search base="prefecture_summary" id="last_published_confirmed">
          <query>
            | eval yesterday=relative_time(now(), "-1d")
            | where _time&lt;yesterday
            | timechart span=1d values(newlyConfirmed)
          </query>
        </search>
        <option name="colorBy">trend</option>
        <option name="colorMode">none</option>
        <option name="drilldown">none</option>
        <option name="numberPrecision">0</option>
        <option name="rangeColors">["0x53a051","0x0877a6","0xf8be34","0xf1813f","0xdc4e41"]</option>
        <option name="rangeValues">[0,30,70,100]</option>
        <option name="refresh.display">progressbar</option>
        <option name="showSparkline">1</option>
        <option name="showTrendIndicator">1</option>
        <option name="trellis.enabled">0</option>
        <option name="trellis.scales.shared">1</option>
        <option name="trellis.size">medium</option>
        <option name="trendColorInterpretation">inverse</option>
        <option name="trendDisplayMode">absolute</option>
        <option name="underLabel">感染者 昨日公表分</option>
        <option name="unit">名</option>
        <option name="unitPosition">after</option>
        <option name="useColors">1</option>
        <option name="useThousandSeparators">1</option>
      </single>
    </panel>
    <panel depends="$debug$">
      <title>感染者 前日公表日 (デバッグ用)</title>
      <single>
        <search base="last_published_confirmed">
          <query>
<!-- published_confirmed -->
            | tail 1
            | eval time=strftime(_time, "%Y/%m/%d")
            | fields time
          </query>
          <done>
            <set token="last_confirmed_date">$result.time$</set>
          </done>
        </search>
        <option name="underLabel">感染者 前日公表日</option>
      </single>
    </panel>
    <panel>
      <title>死亡者 $current_deceased_date$ 公表分</title>
      <single>
        <search base="prefecture_summary" id="published_deceased">
          <query>
<!-- prefecture_summary -->
            | timechart span=1d values(newlyDeceased)
          </query>
        </search>
        <option name="colorBy">trend</option>
        <option name="colorMode">none</option>
        <option name="drilldown">none</option>
        <option name="numberPrecision">0</option>
        <option name="rangeColors">["0x53a051","0x0877a6","0xf8be34","0xf1813f","0xdc4e41"]</option>
        <option name="rangeValues">[0,30,70,100]</option>
        <option name="showSparkline">1</option>
        <option name="showTrendIndicator">1</option>
        <option name="trellis.enabled">0</option>
        <option name="trellis.scales.shared">1</option>
        <option name="trellis.size">medium</option>
        <option name="trendColorInterpretation">inverse</option>
        <option name="trendDisplayMode">absolute</option>
        <option name="underLabel">死亡者 本日公表分</option>
        <option name="unit">名</option>
        <option name="unitPosition">after</option>
        <option name="useColors">1</option>
        <option name="useThousandSeparators">1</option>
      </single>
    </panel>
    <panel depends="$debug$">
      <title>死亡者 公表日 (デバッグ用)</title>
      <single>
        <search base="published_deceased">
          <query>
<!-- published_deceased -->
            | tail 1
            | eval time=strftime(_time, "%Y/%m/%d")
            | fields time
          </query>
          <done>
            <set token="current_deceased_date">$result.time$</set>
          </done>
        </search>
        <option name="underLabel">死亡者 公表日</option>
      </single>
    </panel>
    <panel>
      <title>死亡者 昨日 ($last_deceased_date$) 公表分</title>
      <single>
        <search base="prefecture_summary" id="last_published_deceased">
          <query>
            | eval yesterday=relative_time(now(), "-1d")
            | where _time&lt;yesterday
            | timechart span=1d values(newlyDeceased)
          </query>
        </search>
        <option name="colorBy">trend</option>
        <option name="colorMode">none</option>
        <option name="drilldown">none</option>
        <option name="numberPrecision">0</option>
        <option name="rangeColors">["0x53a051","0x0877a6","0xf8be34","0xf1813f","0xdc4e41"]</option>
        <option name="rangeValues">[0,30,70,100]</option>
        <option name="refresh.display">progressbar</option>
        <option name="showSparkline">1</option>
        <option name="showTrendIndicator">1</option>
        <option name="trellis.enabled">0</option>
        <option name="trellis.scales.shared">1</option>
        <option name="trellis.size">medium</option>
        <option name="trendColorInterpretation">inverse</option>
        <option name="trendDisplayMode">absolute</option>
        <option name="underLabel">死亡者 昨日公表分</option>
        <option name="unit">名</option>
        <option name="unitPosition">after</option>
        <option name="useColors">1</option>
        <option name="useThousandSeparators">1</option>
      </single>
    </panel>
    <panel depends="$debug$">
      <title>死亡者 前日公表日 (デバッグ用)</title>
      <single>
        <search base="last_published_deceased">
          <query>
<!-- last_published_deceased -->
            | tail 1
            | eval time=strftime(_time, "%Y/%m/%d")
            | fields time
          </query>
          <done>
            <set token="last_deceased_date">$result.time$</set>
          </done>
        </search>
        <option name="underLabel">死亡者 前日公表日</option>
      </single>
    </panel>
  </row>
  <row>
    <panel>
      <title>$target_prefecture_ja$  感染者 状況 ($prefectures_last_date$ 現在)</title>
      <table>
        <search base="prefectures_all_base" id="prefecutre_table">
          <query>
<!-- prefectures_all_base -->

            | where _time&gt;=strptime("2020-01-15", "%F")
            | fields _time, daily_confirmed, daily_deceased
            | rename daily_confirmed as "日毎感染数",daily_deceased as "日毎死亡数"
            | sort 0 - _time
            | eval "日付"=strftime(_time, "%F")
            | table "日付", "日毎感染数", "日毎死亡数"
          </query>
        </search>
        <option name="count">10</option>
        <option name="dataOverlayMode">none</option>
        <option name="drilldown">none</option>
        <option name="percentagesRow">false</option>
        <option name="rowNumbers">true</option>
        <option name="totalsRow">true</option>
        <option name="wrap">false</option>
      </table>
    </panel>
    <panel>
      <title>$target_prefecture_ja$ 感染者数累積 ($prefectures_last_date$ 現在)</title>
      <chart>
        <title>円の大きさは死亡者数</title>
        <search base="prefectures_all_base">
          <query>
            | fields _time, name_ja, daily_confirmed, daily_deceased
            | eventstats min(_time) as min_time
            | eval days=floor((_time-min_time)/86400)
            | sort 0 + name_ja, days
            | streamstats sum(daily_confirmed) as "感染", sum(daily_deceased) as "死亡" by name_ja
            | fields - daily_confirmed, daily_deceased
            | rename name_ja as "都道府県"
            | sort 0 - "感染"
            | table "都道府県", days, "感染", "死亡"
          </query>
        </search>
        <option name="charting.axisLabelsX.majorLabelStyle.overflowMode">ellipsisNone</option>
        <option name="charting.axisLabelsX.majorLabelStyle.rotation">0</option>
        <option name="charting.axisTitleX.text">Day0 +</option>
        <option name="charting.axisTitleX.visibility">visible</option>
        <option name="charting.axisTitleY.text">累積感染者数</option>
        <option name="charting.axisTitleY.visibility">visible</option>
        <option name="charting.axisTitleY2.visibility">visible</option>
        <option name="charting.axisX.abbreviation">none</option>
        <option name="charting.axisX.scale">linear</option>
        <option name="charting.axisY.abbreviation">none</option>
        <option name="charting.axisY.minimumNumber">0</option>
        <option name="charting.axisY.scale">linear</option>
        <option name="charting.axisY2.abbreviation">none</option>
        <option name="charting.axisY2.enabled">0</option>
        <option name="charting.axisY2.scale">inherit</option>
        <option name="charting.chart">bubble</option>
        <option name="charting.chart.bubbleMaximumSize">100</option>
        <option name="charting.chart.bubbleMinimumSize">10</option>
        <option name="charting.chart.bubbleSizeBy">area</option>
        <option name="charting.chart.nullValueMode">gaps</option>
        <option name="charting.chart.showDataLabels">none</option>
        <option name="charting.chart.sliceCollapsingThreshold">0.01</option>
        <option name="charting.chart.stackMode">default</option>
        <option name="charting.chart.style">shiny</option>
        <option name="charting.drilldown">none</option>
        <option name="charting.layout.splitSeries">0</option>
        <option name="charting.layout.splitSeries.allowIndependentYRanges">0</option>
        <option name="charting.legend.labelStyle.overflowMode">ellipsisMiddle</option>
        <option name="charting.legend.mode">standard</option>
        <option name="charting.legend.placement">right</option>
        <option name="charting.lineWidth">2</option>
        <option name="height">425</option>
        <option name="refresh.display">progressbar</option>
        <option name="trellis.enabled">0</option>
        <option name="trellis.scales.shared">1</option>
        <option name="trellis.size">medium</option>
      </chart>
    </panel>
    <panel>
      <title>$target_prefecture_ja$ 感染者数累積 ($prefectures_last_date$ 現在)</title>
      <chart>
        <title>縦軸は対数軸</title>
        <search base="prefectures_all_base">
          <query>
<!-- prefectures_all_base -->
            | where _time&gt;=strptime("2020-01-15", "%F")
            | fields _time, name_ja, daily_confirmed
            | streamstats sum(daily_confirmed) as daily_confirmed by name_ja
            | xyseries _time, name_ja, daily_confirmed
            | $predict_query_prefix$$target_prefecture_ja$$predict_query_postfix$
          </query>
        </search>
        <search type="annotation" base="annotation_base">
          <query>
<!-- annotation_base -->
          </query>
        </search>
        <option name="charting.axisLabelsX.majorLabelStyle.overflowMode">ellipsisNone</option>
        <option name="charting.axisLabelsX.majorLabelStyle.rotation">-90</option>
        <option name="charting.axisTitleX.text">日付</option>
        <option name="charting.axisTitleX.visibility">collapsed</option>
        <option name="charting.axisTitleY.text">累積感染者数 (対数)</option>
        <option name="charting.axisTitleY.visibility">visible</option>
        <option name="charting.axisTitleY2.visibility">visible</option>
        <option name="charting.axisX.abbreviation">none</option>
        <option name="charting.axisX.scale">linear</option>
        <option name="charting.axisY.abbreviation">none</option>
        <option name="charting.axisY.minimumNumber">0</option>
        <option name="charting.axisY.scale">log</option>
        <option name="charting.axisY2.abbreviation">none</option>
        <option name="charting.axisY2.enabled">0</option>
        <option name="charting.axisY2.scale">inherit</option>
        <option name="charting.chart">line</option>
        <option name="charting.chart.bubbleMaximumSize">50</option>
        <option name="charting.chart.bubbleMinimumSize">10</option>
        <option name="charting.chart.bubbleSizeBy">area</option>
        <option name="charting.chart.nullValueMode">connect</option>
        <option name="charting.chart.showDataLabels">none</option>
        <option name="charting.chart.sliceCollapsingThreshold">0.01</option>
        <option name="charting.chart.stackMode">default</option>
        <option name="charting.chart.style">shiny</option>
        <option name="charting.drilldown">none</option>
        <option name="charting.layout.splitSeries">0</option>
        <option name="charting.layout.splitSeries.allowIndependentYRanges">0</option>
        <option name="charting.legend.labelStyle.overflowMode">ellipsisMiddle</option>
        <option name="charting.legend.mode">standard</option>
        <option name="charting.legend.placement">right</option>
        <option name="charting.lineWidth">2</option>
        <option name="height">400</option>
        <option name="trellis.enabled">0</option>
        <option name="trellis.scales.shared">1</option>
        <option name="trellis.size">medium</option>
      </chart>
    </panel>
  </row>
  <row>
    <panel>
      <title>日別感染者数 (昨日分まで)</title>
      <input type="dropdown" token="time_earliest" searchWhenChanged="true">
        <label>表示開始日</label>
        <initialValue>-14d@d</initialValue>
        <choice value="0">全期間</choice>
        <choice value="-7d@d">過去1週間</choice>
        <choice value="-14d@d">過去2週間</choice>
        <choice value="-30d@d">過去30日</choice>
        <choice value="-2mon@d">過去2か月</choice>
        <choice value="-3mon@d">過去3か月</choice>
        <choice value="-6mon@mon">過去6か月</choice>
        <choice value="-12mon@mon">過去1年</choice>
        <default>-14d@d</default>
      </input>
      <input type="radio" token="predict_flag" searchWhenChanged="true">
        <label>予測表示</label>
        <choice value="1">表示</choice>
        <choice value="0">非表示</choice>
        <default>0</default>
        <initialValue>0</initialValue>
        <change>
          <condition value="1">
            <set token="use_predict">1</set>
            <set token="predict_query_prefix">predict future_timespan=14 algorithm=LLT "</set>
            <set token="predict_query_postfix">"</set>
          </condition>
          <condition value="0">
            <unset token="use_predict"></unset>
            <set token="predict_query_prefix">eval _dummy="</set>
            <set token="predict_query_postfix">"</set>
          </condition>
        </change>
      </input>
    </panel>
  </row>
  <row>
    <panel>
      <title>$target_prefecture_ja$ 10万人当たりの7日間合計感染者数 ($prefectures_last_date$ 現在)</title>
      <single>
        <search base="sevendays_confirmed">
          <query>
<!-- sevendays_confirmed -->
          </query>
        </search>
        <option name="colorBy">trend</option>
        <option name="colorMode">none</option>
        <option name="drilldown">none</option>
        <option name="height">60</option>
        <option name="numberPrecision">0.000</option>
        <option name="rangeColors">["0xFFFFFF","0xff88ff","0xffcccc","0xff8888","0xff4444","0xff0000"]</option>
        <option name="rangeValues">[0,2000,4000,8000,10000]</option>
        <option name="refresh.display">progressbar</option>
        <option name="trendColorInterpretation">inverse</option>
        <option name="underLabel">10万人当たりの7日間合計感染者数</option>
        <option name="unit">人</option>
        <option name="useColors">1</option>
      </single>
      <chart>
        <search base="prefectures_all_base" id="sevendays_confirmed">
          <query>
<!-- prefectures_all_base -->
            | search name_ja="$target_prefecture_ja$"
            | fields _time, name, name_ja, daily_confirmed, daily_deceased
            | streamstats current=t window=7 sum(daily_confirmed) as sum_7days_confirmed, sum(daily_deceased) as sum_7days_deceased by name_ja
            | fields - daily_confirmed, daily_deceased
            | join name_ja
              [
                | inputlookup populationJapan.csv
                | where '人口'=="総人口"
                | rename "全国・都道府県" as name_ja
                | fields name_ja, "総数"
              ]
            | eval "10万人当たりの7日間合計感染者数"=round(sum_7days_confirmed/('総数'/100),3)
            | fields _time, "10万人当たりの7日間合計感染者数"
            | eval threshold=0.500
            | sort 0 + _time
            | eval local_earliest=if("$time_earliest$"=="0",0,relative_time(now(),"$time_earliest$"))
            | where _time&gt;=local_earliest AND _time&lt;relative_time(now(),"+1d@d")
            | fields - local_earliest
          </query>
        </search>
        <search type="annotation" base="annotation_base">
          <query>
<!-- annotation_base -->
          </query>
        </search>
        <option name="charting.axisLabelsX.majorLabelStyle.overflowMode">ellipsisNone</option>
        <option name="charting.axisLabelsX.majorLabelStyle.rotation">-90</option>
        <option name="charting.axisTitleX.visibility">collapsed</option>
        <option name="charting.axisTitleY.visibility">visible</option>
        <option name="charting.axisTitleY2.visibility">visible</option>
        <option name="charting.axisX.abbreviation">none</option>
        <option name="charting.axisX.scale">linear</option>
        <option name="charting.axisY.abbreviation">none</option>
        <option name="charting.axisY.scale">linear</option>
        <option name="charting.axisY2.abbreviation">none</option>
        <option name="charting.axisY2.enabled">0</option>
        <option name="charting.axisY2.scale">inherit</option>
        <option name="charting.chart">area</option>
        <option name="charting.chart.bubbleMaximumSize">50</option>
        <option name="charting.chart.bubbleMinimumSize">10</option>
        <option name="charting.chart.bubbleSizeBy">area</option>
        <option name="charting.chart.nullValueMode">gaps</option>
        <option name="charting.chart.overlayFields">threshold</option>
        <option name="charting.chart.showDataLabels">none</option>
        <option name="charting.chart.sliceCollapsingThreshold">0.01</option>
        <option name="charting.chart.stackMode">default</option>
        <option name="charting.chart.style">shiny</option>
        <option name="charting.drilldown">none</option>
        <option name="charting.layout.splitSeries">0</option>
        <option name="charting.layout.splitSeries.allowIndependentYRanges">0</option>
        <option name="charting.legend.labelStyle.overflowMode">ellipsisMiddle</option>
        <option name="charting.legend.mode">standard</option>
        <option name="charting.legend.placement">none</option>
        <option name="charting.lineWidth">2</option>
        <option name="height">500</option>
        <option name="trellis.enabled">0</option>
        <option name="trellis.scales.shared">1</option>
        <option name="trellis.size">medium</option>
      </chart>
    </panel>
    <panel>
      <title>$target_prefecture_ja$ 実効再生産数  ($prefectures_last_date$ 現在)</title>
      <single>
        <search base="effective_reproduce_base">
          <query>
<!-- effective_reproduce_base -->
          </query>
        </search>
        <option name="colorBy">trend</option>
        <option name="colorMode">none</option>
        <option name="drilldown">none</option>
        <option name="height">60</option>
        <option name="numberPrecision">0.000</option>
        <option name="rangeColors">["0xFFFFFF","0xff88ff","0xffcccc","0xff8888","0xff4444","0xff0000"]</option>
        <option name="rangeValues">[0,2000,4000,8000,10000]</option>
        <option name="refresh.display">progressbar</option>
        <option name="trendColorInterpretation">inverse</option>
        <option name="underLabel">実効再生産数</option>
        <option name="unit">人</option>
        <option name="useColors">1</option>
      </single>
      <chart>
        <search base="prefectures_all_base" id="effective_reproduce_base">
          <query>
<!-- prefectures_all_base -->
            | fields _time, newlyConfirmed
            | streamstats current=true window=7 sum(*) as 7days_sum_*
            | streamstats current=false window=7 first(7days_sum_*) as prev_7days_sum_*
            | eval term=5
            | eval rep=7
            | foreach 7days_sum_* [ eval "&lt;&lt;MATCHSTR&gt;&gt;"=round(pow(('7days_sum_&lt;&lt;MATCHSTR&gt;&gt;' / 'prev_7days_sum_&lt;&lt;MATCHSTR&gt;&gt;'),(term/rep)), 3) ]
            | fields - *7days_sum_*, rep, term
            | foreach * [ fillnull value=0.000 "&lt;&lt;FIELD&gt;&gt;" ]
            | eval threshold=1.000
            | rename newlyConfirmed as "$target_prefecture_ja$"
            | eval local_earliest=if("$time_earliest$"=="0",0,relative_time(now(),"$time_earliest$"))
            | where _time&gt;=local_earliest AND _time&lt;relative_time(now(),"+1d@d")
            | fields - local_earliest
          </query>
        </search>
        <search type="annotation" base="annotation_base">
          <query>
<!-- annotation_base -->
          </query>
        </search>
        <option name="charting.axisLabelsX.majorLabelStyle.overflowMode">ellipsisNone</option>
        <option name="charting.axisLabelsX.majorLabelStyle.rotation">-90</option>
        <option name="charting.axisTitleX.visibility">collapsed</option>
        <option name="charting.axisTitleY.visibility">visible</option>
        <option name="charting.axisTitleY2.visibility">visible</option>
        <option name="charting.axisX.abbreviation">none</option>
        <option name="charting.axisX.scale">linear</option>
        <option name="charting.axisY.abbreviation">none</option>
        <option name="charting.axisY.scale">linear</option>
        <option name="charting.axisY2.abbreviation">none</option>
        <option name="charting.axisY2.enabled">0</option>
        <option name="charting.axisY2.scale">inherit</option>
        <option name="charting.chart">area</option>
        <option name="charting.chart.bubbleMaximumSize">50</option>
        <option name="charting.chart.bubbleMinimumSize">10</option>
        <option name="charting.chart.bubbleSizeBy">area</option>
        <option name="charting.chart.nullValueMode">connect</option>
        <option name="charting.chart.overlayFields">threshold</option>
        <option name="charting.chart.showDataLabels">none</option>
        <option name="charting.chart.sliceCollapsingThreshold">0.01</option>
        <option name="charting.chart.stackMode">default</option>
        <option name="charting.chart.style">shiny</option>
        <option name="charting.drilldown">none</option>
        <option name="charting.layout.splitSeries">0</option>
        <option name="charting.layout.splitSeries.allowIndependentYRanges">0</option>
        <option name="charting.legend.labelStyle.overflowMode">ellipsisMiddle</option>
        <option name="charting.legend.mode">standard</option>
        <option name="charting.legend.placement">none</option>
        <option name="charting.lineWidth">2</option>
        <option name="height">500</option>
        <option name="refresh.display">progressbar</option>
        <option name="trellis.enabled">0</option>
        <option name="trellis.scales.shared">1</option>
        <option name="trellis.size">medium</option>
      </chart>
    </panel>
    <panel>
      <title>$target_prefecture_ja$ 集計 ($prefectures_last_date$ 現在)</title>
      <!--
    </panel>
    <panel>
      <title>$target_prefecture_ja$ 集計 ($prefectures_last_date$ 現在)</title>
-->
      <chart>
        <title>縦軸は線形軸</title>
        <search base="daily_cofirmed_base" id="daily_single_prefecture_confirmed">
          <query>
<!-- prefectures_all_base -->
<!-- daily_cofirmed_base -->
            | eval local_earliest=if("$time_earliest$"=="0",0,relative_time(now(),"$time_earliest$"))
            | where _time&gt;=local_earliest AND _time&lt;relative_time(now(),"+1d@d")
            | fields - local_earliest
            | $predict_query_prefix$$target_prefecture_ja$$predict_query_postfix$
          </query>
        </search>
        <search type="annotation" base="annotation_base">
          <query>
<!-- annotation_base -->
          </query>
        </search>
        <option name="charting.axisLabelsX.majorLabelStyle.overflowMode">ellipsisNone</option>
        <option name="charting.axisLabelsX.majorLabelStyle.rotation">-90</option>
        <option name="charting.axisTitleX.text">公表日付</option>
        <option name="charting.axisTitleX.visibility">visible</option>
        <option name="charting.axisTitleY.visibility">collapsed</option>
        <option name="charting.axisTitleY2.visibility">visible</option>
        <option name="charting.axisX.abbreviation">none</option>
        <option name="charting.axisX.scale">linear</option>
        <option name="charting.axisY.abbreviation">none</option>
        <option name="charting.axisY.minimumNumber">0</option>
        <option name="charting.axisY.scale">linear</option>
        <option name="charting.axisY2.abbreviation">none</option>
        <option name="charting.axisY2.enabled">0</option>
        <option name="charting.axisY2.scale">inherit</option>
        <option name="charting.chart">area</option>
        <option name="charting.chart.bubbleMaximumSize">50</option>
        <option name="charting.chart.bubbleMinimumSize">10</option>
        <option name="charting.chart.bubbleSizeBy">area</option>
        <option name="charting.chart.nullValueMode">connect</option>
        <option name="charting.chart.showDataLabels">none</option>
        <option name="charting.chart.sliceCollapsingThreshold">0.01</option>
        <option name="charting.chart.stackMode">default</option>
        <option name="charting.chart.style">shiny</option>
        <option name="charting.drilldown">none</option>
        <option name="charting.layout.splitSeries">0</option>
        <option name="charting.layout.splitSeries.allowIndependentYRanges">0</option>
        <option name="charting.legend.labelStyle.overflowMode">ellipsisMiddle</option>
        <option name="charting.legend.mode">standard</option>
        <option name="charting.legend.placement">none</option>
        <option name="charting.lineWidth">2</option>
        <option name="height">300</option>
        <option name="refresh.display">preview</option>
        <option name="trellis.enabled">0</option>
        <option name="trellis.scales.shared">1</option>
        <option name="trellis.size">medium</option>
      </chart>
      <chart>
        <title>縦軸は対数軸</title>
        <search base="daily_single_prefecture_confirmed">
          <query>
<!-- prefectures_all_base -->
<!-- daily_cofirmed_base -->
<!-- daily_single_prefecture_confirmed -->
          </query>
        </search>
        <search type="annotation" base="annotation_base">
          <query>
<!-- annotation_base -->
          </query>
        </search>
        <option name="charting.axisLabelsX.majorLabelStyle.overflowMode">ellipsisNone</option>
        <option name="charting.axisLabelsX.majorLabelStyle.rotation">-90</option>
        <option name="charting.axisTitleX.text">公表日付</option>
        <option name="charting.axisTitleX.visibility">visible</option>
        <option name="charting.axisTitleY.visibility">collapsed</option>
        <option name="charting.axisTitleY2.visibility">visible</option>
        <option name="charting.axisX.abbreviation">none</option>
        <option name="charting.axisX.scale">linear</option>
        <option name="charting.axisY.abbreviation">none</option>
        <option name="charting.axisY.minimumNumber">0</option>
        <option name="charting.axisY.scale">log</option>
        <option name="charting.axisY2.abbreviation">none</option>
        <option name="charting.axisY2.enabled">1</option>
        <option name="charting.axisY2.minimumNumber">0</option>
        <option name="charting.axisY2.scale">inherit</option>
        <option name="charting.chart">column</option>
        <option name="charting.chart.bubbleMaximumSize">50</option>
        <option name="charting.chart.bubbleMinimumSize">10</option>
        <option name="charting.chart.bubbleSizeBy">area</option>
        <option name="charting.chart.nullValueMode">gaps</option>
        <option name="charting.chart.overlayFields">合計</option>
        <option name="charting.chart.showDataLabels">none</option>
        <option name="charting.chart.sliceCollapsingThreshold">0.01</option>
        <option name="charting.chart.stackMode">default</option>
        <option name="charting.chart.style">shiny</option>
        <option name="charting.drilldown">none</option>
        <option name="charting.layout.splitSeries">0</option>
        <option name="charting.layout.splitSeries.allowIndependentYRanges">0</option>
        <option name="charting.legend.labelStyle.overflowMode">ellipsisMiddle</option>
        <option name="charting.legend.mode">standard</option>
        <option name="charting.legend.placement">none</option>
        <option name="charting.lineWidth">2</option>
        <option name="height">300</option>
        <option name="trellis.enabled">0</option>
        <option name="trellis.scales.shared">1</option>
        <option name="trellis.size">medium</option>
      </chart>
    </panel>
  </row>
  <row>
    <panel>
      <title>$target_prefecture_ja$ 集計 ($prefectures_last_date$ 現在)</title>
      <chart>
        <search base="prefecture_summary">
          <query>
            | eval confirmed=confirmed - (deceased + recovered)
            | rename name_ja as "都道府県", confirmed as "感染", deceased as "死亡", recovered as "回復"
            | table "感染", "死亡", "回復"
            | transpose column_name=count
          </query>
        </search>
        <option name="height">300</option>
        <option name="charting.axisLabelsX.majorLabelStyle.overflowMode">ellipsisNone</option>
        <option name="charting.axisLabelsX.majorLabelStyle.rotation">0</option>
        <option name="charting.axisTitleX.visibility">visible</option>
        <option name="charting.axisTitleY.visibility">visible</option>
        <option name="charting.axisTitleY2.visibility">visible</option>
        <option name="charting.axisX.abbreviation">none</option>
        <option name="charting.axisX.scale">linear</option>
        <option name="charting.axisY.abbreviation">none</option>
        <option name="charting.axisY.scale">linear</option>
        <option name="charting.axisY2.abbreviation">none</option>
        <option name="charting.axisY2.enabled">0</option>
        <option name="charting.axisY2.scale">inherit</option>
        <option name="charting.chart">pie</option>
        <option name="charting.chart.bubbleMaximumSize">50</option>
        <option name="charting.chart.bubbleMinimumSize">10</option>
        <option name="charting.chart.bubbleSizeBy">area</option>
        <option name="charting.chart.nullValueMode">gaps</option>
        <option name="charting.chart.showDataLabels">all</option>
        <option name="charting.chart.sliceCollapsingThreshold">0.01</option>
        <option name="charting.chart.stackMode">stacked100</option>
        <option name="charting.chart.style">shiny</option>
        <option name="charting.drilldown">none</option>
        <option name="charting.layout.splitSeries">0</option>
        <option name="charting.layout.splitSeries.allowIndependentYRanges">0</option>
        <option name="charting.legend.labelStyle.overflowMode">ellipsisMiddle</option>
        <option name="charting.legend.mode">standard</option>
        <option name="charting.legend.placement">right</option>
        <option name="charting.lineWidth">2</option>
        <option name="refresh.display">progressbar</option>
        <option name="trellis.enabled">0</option>
        <option name="trellis.scales.shared">1</option>
        <option name="trellis.size">medium</option>
      </chart>
    </panel>
    <panel>
      <title>$target_prefecture_ja$ 曜日別公表数平均 ($prefectures_last_date$ 現在)</title>
      <chart>
        <search base="prefecutre_table">
          <query>
<!-- prefecutre_table -->
            | eval wday=strptime('日付',"%F")
            | eval wday=strftime(wday, "%w")
            | stats avg(*) as "* (平均)" by wday
            | eval "日毎感染数 (平均)"=round('日毎感染数 (平均)', 2)
            | eval "日毎死亡数 (平均)"=round('日毎死亡数 (平均)', 2)
            | eval wday=case(wday=0,"日",wday=1,"月",wday=2,"火",wday=3,"水",wday=4,"木",wday=5,"金",wday=6,"土")
          </query>
        </search>
        <option name="charting.axisLabelsX.majorLabelStyle.overflowMode">ellipsisNone</option>
        <option name="charting.axisLabelsX.majorLabelStyle.rotation">0</option>
        <option name="charting.axisTitleX.text">曜日</option>
        <option name="charting.axisTitleX.visibility">visible</option>
        <option name="charting.axisTitleY.visibility">visible</option>
        <option name="charting.axisTitleY2.visibility">visible</option>
        <option name="charting.axisX.abbreviation">none</option>
        <option name="charting.axisX.scale">linear</option>
        <option name="charting.axisY.abbreviation">none</option>
        <option name="charting.axisY.scale">linear</option>
        <option name="charting.axisY2.abbreviation">none</option>
        <option name="charting.axisY2.enabled">1</option>
        <option name="charting.axisY2.scale">inherit</option>
        <option name="charting.chart">line</option>
        <option name="charting.chart.bubbleMaximumSize">50</option>
        <option name="charting.chart.bubbleMinimumSize">10</option>
        <option name="charting.chart.bubbleSizeBy">area</option>
        <option name="charting.chart.nullValueMode">gaps</option>
        <option name="charting.chart.overlayFields">"日毎死亡数 (平均)"</option>
        <option name="charting.chart.showDataLabels">none</option>
        <option name="charting.chart.sliceCollapsingThreshold">0.01</option>
        <option name="charting.chart.stackMode">default</option>
        <option name="charting.chart.style">shiny</option>
        <option name="charting.drilldown">none</option>
        <option name="charting.layout.splitSeries">0</option>
        <option name="charting.layout.splitSeries.allowIndependentYRanges">0</option>
        <option name="charting.legend.labelStyle.overflowMode">ellipsisMiddle</option>
        <option name="charting.legend.mode">standard</option>
        <option name="charting.legend.placement">bottom</option>
        <option name="charting.lineWidth">2</option>
        <option name="height">400</option>
        <option name="trellis.enabled">0</option>
        <option name="trellis.scales.shared">1</option>
        <option name="trellis.size">medium</option>
      </chart>
    </panel>
    <panel>
      <title>前日比増加率 ($prefectures_last_date$ 現在)</title>
      <chart>
        <search base="prefecture_summary">
          <query>
<!-- prefecture_summary -->

            | eval daily_confirmed_rate=newlyConfirmed/yesterdayConfirmed
            | fillnull value=0 daily_confirmed_rate
            | eval constant=1
            | timechart span=1d values(daily_confirmed_rate) as "感染者前日比", values(constant) as "増減境界"
          </query>
        </search>
        <search type="annotation" base="annotation_base">
          <query>
<!-- annotation_base -->
          </query>
        </search>
        <option name="charting.axisLabelsX.majorLabelStyle.overflowMode">ellipsisNone</option>
        <option name="charting.axisLabelsX.majorLabelStyle.rotation">0</option>
        <option name="charting.axisTitleX.visibility">collapsed</option>
        <option name="charting.axisTitleY.text">前日比</option>
        <option name="charting.axisTitleY.visibility">visible</option>
        <option name="charting.axisTitleY2.visibility">visible</option>
        <option name="charting.axisX.abbreviation">none</option>
        <option name="charting.axisX.scale">linear</option>
        <option name="charting.axisY.abbreviation">none</option>
        <option name="charting.axisY.scale">linear</option>
        <option name="charting.axisY2.abbreviation">none</option>
        <option name="charting.axisY2.enabled">0</option>
        <option name="charting.axisY2.scale">inherit</option>
        <option name="charting.chart">line</option>
        <option name="charting.chart.bubbleMaximumSize">50</option>
        <option name="charting.chart.bubbleMinimumSize">10</option>
        <option name="charting.chart.bubbleSizeBy">area</option>
        <option name="charting.chart.nullValueMode">zero</option>
        <option name="charting.chart.overlayFields">増減境界</option>
        <option name="charting.chart.showDataLabels">none</option>
        <option name="charting.chart.sliceCollapsingThreshold">0.01</option>
        <option name="charting.chart.stackMode">default</option>
        <option name="charting.chart.style">shiny</option>
        <option name="charting.drilldown">none</option>
        <option name="charting.layout.splitSeries">0</option>
        <option name="charting.layout.splitSeries.allowIndependentYRanges">0</option>
        <option name="charting.legend.labelStyle.overflowMode">ellipsisMiddle</option>
        <option name="charting.legend.mode">standard</option>
        <option name="charting.legend.placement">none</option>
        <option name="charting.lineWidth">2</option>
        <option name="height">400</option>
        <option name="trellis.enabled">0</option>
        <option name="trellis.scales.shared">1</option>
        <option name="trellis.size">medium</option>
      </chart>
    </panel>
  </row>
  <row>
    <panel>
      <title>データソース:</title>
      <html>
        <ul>
          <li>
            <a href="https://covid19japan.com/" target="_blank">"Coronavirus Disease (COVID-19) Japan Tracker" (https://covid19japan.com/)</a>
          </li>
          <li>
            <a href="https://www.e-stat.go.jp/stat-search/database?page=1&amp;statdisp_id=0003412322">人口推計 / 2019年10月1日現在人口推計</a> (「人口推計 010 都道府県，年齢（5歳階級），男女別人口－総人口，日本人人口」政府統計の総合窓口)
          </li>
<!--
          <li>
            マップタイル出典: 
              <ul>
                <li>
                  <a href="https://cran.r-project.org/web/packages/NipponMap/index.html" target="_blank">"NipponMap" (https://cran.r-project.org/web/packages/NipponMap/index.html)</a>
                </li>
                <li>
                  <a href="https://maps.gsi.go.jp/development/ichiran.html" target="_blank">地理院タイル (https://maps.gsi.go.jp/development/ichiran.html)</a>
                </li>
              </ul>
          </li>
-->
        </ul>
      </html>
    </panel>
  </row>
</form>